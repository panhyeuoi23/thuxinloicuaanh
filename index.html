<!doctype html>
<html lang="vi">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Th∆∞ xin l·ªói</title>
  <style>
    :root{
      --bg1:#0b1020; --bg2:#1b0b1b;
      --card: rgba(255,255,255,.08);
      --stroke: rgba(255,255,255,.14);
      --text: rgba(255,255,255,.92);
      --muted: rgba(255,255,255,.68);
      --accent: #ff4d7d;
      --accent2:#ffd166;
      --shadow: 0 24px 70px rgba(0,0,0,.45);
      --radius: 22px;
    }
    *{box-sizing:border-box}
    body{
      margin:0; min-height:100vh; color:var(--text);
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial;
      background: radial-gradient(1200px 800px at 20% 10%, rgba(255,77,125,.20), transparent 55%),
                  radial-gradient(900px 700px at 80% 30%, rgba(255,209,102,.18), transparent 55%),
                  linear-gradient(135deg, var(--bg1), var(--bg2));
      overflow-x:hidden;
    }
    .stars{
      position:fixed; inset:0; pointer-events:none; opacity:.55;
      background-image:
        radial-gradient(2px 2px at 20px 30px, rgba(255,255,255,.55), transparent 60%),
        radial-gradient(1px 1px at 160px 90px, rgba(255,255,255,.35), transparent 60%),
        radial-gradient(2px 2px at 260px 220px, rgba(255,255,255,.45), transparent 60%),
        radial-gradient(1px 1px at 420px 160px, rgba(255,255,255,.35), transparent 60%),
        radial-gradient(2px 2px at 620px 320px, rgba(255,255,255,.45), transparent 60%);
      background-size: 700px 420px;
      animation: drift 18s linear infinite;
    }
    @keyframes drift{ from{transform:translateY(0)} to{transform:translateY(-60px)} }

    .wrap{
      min-height:100vh;
      display:grid;
      place-items:center;
      padding:26px 16px;
    }
    .card{
      width:min(880px, 92vw);
      border:1px solid var(--stroke);
      background: linear-gradient(180deg, rgba(255,255,255,.10), rgba(255,255,255,.06));
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      backdrop-filter: blur(14px);
      padding: 22px;
    }
    .topbar{
      display:flex; align-items:center; justify-content:space-between;
      gap:12px; margin-bottom:18px;
    }
    .brand{
      display:flex; align-items:center; gap:10px;
    }
    .dot{
      width:12px; height:12px; border-radius:50%;
      background: radial-gradient(circle at 30% 30%, #fff, var(--accent));
      box-shadow: 0 0 18px rgba(255,77,125,.55);
    }
    .title{
      font-weight:700; letter-spacing:.2px;
    }
    .sub{
      color:var(--muted); font-size:13px; margin-top:2px;
    }
    .controls{
      display:flex; gap:10px; align-items:center;
    }
    .btn{
      border:1px solid var(--stroke);
      background: rgba(255,255,255,.06);
      color:var(--text);
      padding:10px 12px;
      border-radius: 14px;
      cursor:pointer;
      font-weight:600;
      transition: transform .08s ease, background .2s ease;
      user-select:none;
    }
    .btn:hover{ background: rgba(255,255,255,.10); }
    .btn:active{ transform: translateY(1px); }
    .btn.primary{
      border-color: rgba(255,77,125,.45);
      background: rgba(255,77,125,.18);
    }

    .main{
      display:grid;
      grid-template-columns: 1.05fr .95fr;
      gap:18px;
    }
    @media (max-width: 860px){
      .main{ grid-template-columns: 1fr; }
    }

    /* Envelope scene */
    .scene{
      border:1px solid var(--stroke);
      background: rgba(0,0,0,.14);
      border-radius: var(--radius);
      padding: 18px;
      position:relative;
      overflow:hidden;
      min-height: 360px;
      display:grid;
      place-items:center;
    }
    .glow{
      position:absolute; inset:-40%;
      background: radial-gradient(circle at 30% 30%, rgba(255,77,125,.20), transparent 55%),
                  radial-gradient(circle at 70% 60%, rgba(255,209,102,.18), transparent 58%);
      filter: blur(18px);
      opacity:.9;
      animation: pulse 4.8s ease-in-out infinite;
    }
    @keyframes pulse{ 0%,100%{transform:scale(1)} 50%{transform:scale(1.06)} }

    .envelopeWrap{
      position:relative;
      width: 280px; height: 190px;
      transform: translateY(8px);
    }
    .envelope{
      position:absolute; inset:0;
      border-radius: 18px;
      background: linear-gradient(180deg, rgba(255,255,255,.16), rgba(255,255,255,.08));
      border:1px solid rgba(255,255,255,.18);
      box-shadow: 0 18px 40px rgba(0,0,0,.35);
      overflow:hidden;
    }
    .envelope:before{
      content:"";
      position:absolute; inset:0;
      background:
        radial-gradient(500px 220px at 50% 120%, rgba(255,255,255,.18), transparent 58%);
      opacity:.8;
    }
    .flap{
      position:absolute;
      left:0; right:0; top:0;
      height: 62%;
      transform-origin: top center;
      transform: rotateX(0deg);
      transition: transform .8s cubic-bezier(.2,.9,.1,1);
      background: linear-gradient(180deg, rgba(255,255,255,.20), rgba(255,255,255,.06));
      clip-path: polygon(0 0, 100% 0, 50% 100%);
      border-bottom:1px solid rgba(255,255,255,.18);
      filter: drop-shadow(0 12px 22px rgba(0,0,0,.25));
    }
    .bodyTri{
      position:absolute; inset:0;
      clip-path: polygon(0 100%, 50% 55%, 100% 100%, 100% 0, 0 0);
      background: linear-gradient(180deg, rgba(255,255,255,.10), rgba(255,255,255,.06));
    }
    .seal{
      position:absolute;
      left:50%; top:58%;
      width: 54px; height:54px;
      transform: translate(-50%,-50%);
      border-radius: 999px;
      background: radial-gradient(circle at 30% 30%, #fff, var(--accent));
      box-shadow: 0 0 20px rgba(255,77,125,.55);
      display:grid; place-items:center;
      font-weight:900;
      color: rgba(20,10,16,.85);
      letter-spacing:.5px;
      user-select:none;
      transition: transform .35s ease, opacity .35s ease;
    }
    .letterPaper{
      position:absolute;
      left: 50%;
      bottom: 14px;
      width: 240px;
      height: 150px;
      transform: translateX(-50%) translateY(46px);
      border-radius: 16px;
      background: linear-gradient(180deg, rgba(255,255,255,.94), rgba(255,255,255,.85));
      box-shadow: 0 20px 40px rgba(0,0,0,.30);
      border: 1px solid rgba(0,0,0,.06);
      transition: transform .9s cubic-bezier(.2,.95,.1,1);
      overflow:hidden;
    }
    .paperLines{
      position:absolute; inset:14px 16px 16px;
      background:
        linear-gradient(to bottom, rgba(255,77,125,.10), rgba(255,77,125,.10)) 0 22px/100% 2px,
        linear-gradient(to bottom, rgba(0,0,0,.06), rgba(0,0,0,.06)) 0 46px/100% 2px,
        linear-gradient(to bottom, rgba(0,0,0,.06), rgba(0,0,0,.06)) 0 70px/100% 2px,
        linear-gradient(to bottom, rgba(0,0,0,.06), rgba(0,0,0,.06)) 0 94px/100% 2px,
        linear-gradient(to bottom, rgba(0,0,0,.06), rgba(0,0,0,.06)) 0 118px/100% 2px;
      background-repeat:no-repeat;
      opacity:.9;
    }
    .tapHint{
      margin-top:14px;
      color:var(--muted);
      font-size:13px;
      text-align:center;
    }
    .cta{
      margin-top:14px;
      display:flex;
      gap:10px;
      justify-content:center;
      flex-wrap:wrap;
    }
/* FIX: buttons not clickable (bring CTA above overlays) */
.scene { position: relative; }
.cta { position: relative; z-index: 20; pointer-events: auto; }
.cta .btn { pointer-events: auto; }
.envelope, .glow { pointer-events: none; }
    /* Open state */
    .envelopeWrap.open .flap{ transform: rotateX(155deg); }
    .envelopeWrap.open .letterPaper{ transform: translateX(-50%) translateY(-66px); }
    .envelopeWrap.open .seal{ transform: translate(-50%,-50%) scale(.9); opacity:.35; }

    /* Right side: letter modal */
    .panel{
      border:1px solid var(--stroke);
      background: rgba(0,0,0,.10);
      border-radius: var(--radius);
      padding: 18px;
      min-height: 360px;
      position:relative;
      overflow:hidden;
    }
    .panel h3{ margin:0; font-size:18px; }
    .panel p{ color:var(--muted); margin:10px 0 0; line-height:1.6; }

    .modal{
      position:fixed; inset:0;
      display:none;
      place-items:center;
      padding: 18px;
      background: rgba(0,0,0,.55);
      backdrop-filter: blur(8px);
      z-index: 50;
    }
    .modal.show{ display:grid; }
    .sheet{
      width:min(760px, 94vw);
      background: rgba(255,255,255,.94);
      color:#111;
      border-radius: 22px;
      box-shadow: 0 28px 80px rgba(0,0,0,.55);
      padding: 22px 20px;
      position:relative;
      animation: pop .22s ease-out;
    }
    @keyframes pop{ from{transform:translateY(10px); opacity:.6} to{transform:translateY(0); opacity:1} }
    .sheet h2{ margin:0 0 10px; font-size:20px; }
    .sheet .text{ white-space:pre-wrap; line-height:1.75; font-size:16px; }
    .sheet .sig{ margin-top:14px; opacity:.9; }
    .x{
      position:absolute; right:12px; top:12px;
      border:0; cursor:pointer;
      width:40px; height:40px; border-radius:14px;
      background: rgba(0,0,0,.06);
      font-weight:900;
    }
    .x:hover{ background: rgba(0,0,0,.10); }

    /* small toast */
    .toast{
      position:fixed; left:50%; bottom:16px; transform:translateX(-50%);
      background: rgba(0,0,0,.55);
      border:1px solid rgba(255,255,255,.18);
      color:rgba(255,255,255,.9);
      padding:10px 12px;
      border-radius: 14px;
      display:none;
      z-index:60;
      font-size:13px;
    }
    .toast.show{ display:block; }
  </style>
</head>
<body>
  <div class="stars"></div>

  <div class="wrap">
    <div class="card">
      <div class="topbar">
        <div class="brand">
          <div class="dot"></div>
          <div>
            <div class="title">Th∆∞ n√†y anh mu·ªën g·ª≠i ƒë·∫øn v·ª£ anh</div>
            <div class="sub">B·∫•m ‚ÄúM·ªü th∆∞‚Äù ho·∫∑c ch·∫°m v√†o phong th∆∞.</div>
          </div>
        </div>

        <div class="controls">
          <button class="btn" id="musicBtn">‚ô´ B·∫≠t nh·∫°c</button>
          <button class="btn primary" id="openBtn">üíå M·ªü th∆∞</button>
        </div>
      </div>

      <div class="main">
        <div class="scene" id="scene">
          <div class="glow"></div>

          <div class="envelopeWrap" id="env" style="pointer-events:auto; z-index:10;">
            <div class="envelope">
              <div class="flap"></div>
              <div class="bodyTri"></div>
              <div class="seal">S</div>
              <div class="letterPaper">
                <div class="paperLines"></div>
              </div>
            </div>
          </div>

          <div class="tapHint">Ch·∫°m v√†o phong th∆∞ ƒë·ªÉ m·ªü ‚ú®</div>

          <div class="cta">
            <button class="btn primary" id="readBtn">üìñ ƒê·ªçc th∆∞</button>
            <button class="btn" id="closeAnimBtn">‚Ü© ƒê√≥ng phong th∆∞</button>
          </div>
        </div>

        <div class="panel">
          <h3>L·ªùi nh·∫Øn</h3>
          <p>
            ‚Ä¢ B·∫•m v√†o n√∫t m·ªü nh·∫°c ƒë·ªÉ nghe nh·∫°c nh√© v·ª£ ∆°i.<br/>
            ‚Ä¢ Anh mong l√° th∆∞ n√†y s·∫Ω xoa d·ªãu ƒë∆∞·ª£c v·ª£ ph·∫ßn n√†o.<br/>
            ‚Ä¢ Anh y√™u v·ª£.
          </p>

          <p style="margin-top:14px;color:rgba(255,255,255,.78)">
            Khi v·ª£ s·∫µn s√†ng, b·∫•m <b>ƒê·ªçc th∆∞</b>.
          </p>
        </div>
      </div>
    </div>
  </div>

  <!-- Modal letter -->
  <div class="modal" id="modal">
    <div class="sheet" role="dialog" aria-modal="true">
      <button class="x" id="closeModal" aria-label="ƒê√≥ng">‚úï</button>
      <h2>G·ª≠i b√© Anh,</h2>

      <!-- ====== N·ªòI DUNG TH∆Ø: s·ª≠a t·∫°i ƒë√¢y ====== -->
      <div class="text" id="letterText">
ƒê·∫ßu ti√™n, v·ª£ cho anh xin l·ªói v√¨ ƒë√£ l√†m v·ª£ bu·ªìn v√† kh√≥ ch·ªãu.

Th·ª±c s·ª± l√† anh ƒë√£ sai khi ƒë√£ kh√¥ng ƒë·ªÉ √Ω ƒë·∫øn vi·ªác c√°i t√™n c·ªßa Account, nh∆∞ng anh kh√¥ng h·ªÅ c·ªë √Ω ƒë·ªÉ nh∆∞ v·∫≠y ch·ªâ l√† anh mu·ªën l√†m th·∫≠t nhanh ƒë·ªÉ c√≤n k·ªãp t·∫∑ng v·ª£ trong ng√†y Noel v√† l√∫c xong th√¨ anh n√¥n n√≥ng, anh mu·ªën khoe v·ªõi v·ª£ li·ªÅn n√™n anh ƒë√£ kh√¥ng ƒë·ªÉ √Ω, kh√¥ng check l·∫°i t√™n. Anh mu·ªën n√≥i v·ªõi v·ª£ l√† anh kh√¥ng h·ªÅ quan tr·ªçng hay ƒë·ªÉ t√¢m hay l√† nh·ªõ g√¨ ƒë·∫øn con s·ªë ƒë√≥ c·∫£. V·ª£ l√† hi·ªán t·∫°i v√† l√† t∆∞∆°ng lai c·ªßa anh. M·ª•c ƒë√≠ch anh v√†o c√°i t√†i kho·∫£n ƒë√≥ c≈©ng ch·ªâ l√† ƒë·ªÉ l√†m m·ªôt m√≥n qu√† t·∫∑ng cho v·ª£. Nh∆∞ng m√† v√¨ c√°i t√≠nh h·∫•p t·∫•p anh ƒë√£ l√†m h·ªèng h·∫øt t·∫•t c·∫£ th·ª±c s·ª± anh xin l·ªói v·ª£ nhi·ªÅu l·∫Øm. Nh∆∞ng m√† anh xin v·ª£ ƒë·ª´ng bao gi·ªù nghi ng·ªù t√¨nh c·∫£m hay suy nghƒ© g√¨ c·ªßa anh. Anh th∆∞∆°ng v·ª£ r·∫•t nhi·ªÅu, nhi·ªÅu h∆°n c·∫£ nh·ªØng g√¨ c√≥ th·ªÉ di·ªÖn t·∫£ b·∫±ng l·ªùi n√≥i.

Anh kh√¥ng mu·ªën bi·ªán minh. Anh ch·ªâ mu·ªën nh·∫≠n l·ªói v√† mong v·ª£ cho anh c∆° h·ªôi ƒë·ªÉ s·ª≠a sai b·∫±ng h√†nh ƒë·ªông, kh√¥ng ch·ªâ b·∫±ng l·ªùi n√≥i.

Anh xin l·ªói v·ª£ r·∫•t nhi·ªÅu. Mong v·ª£ s·∫Ω tha l·ªói cho anh. 

Anh y√™u v·ª£ r·∫•t nhi·ªÅu ü§ç
      </div>
      <!-- ====================================== -->

      <div class="sig">
        <div>‚Äî <b>Ho√†ng Tu·∫•n</b></div>
      </div>
    </div>
  </div>

  <div class="toast" id="toast"></div>

  <audio id="bgm" preload="auto" loop>
    <source src="music.mp3" type="audio/mpeg">
  </audio>

  <script>
  const env = document.getElementById('env');
  const openBtn = document.getElementById('openBtn');
  const readBtn = document.getElementById('readBtn');
  const closeAnimBtn = document.getElementById('closeAnimBtn');

  const modal = document.getElementById('modal');
  const closeModal = document.getElementById('closeModal');

  const bgm = document.getElementById('bgm');
  const musicBtn = document.getElementById('musicBtn');

  const toast = document.getElementById('toast');

  let isOpen = false;
  let musicOn = false;

  function showToast(msg){
    toast.textContent = msg;
    toast.classList.add('show');
    setTimeout(()=>toast.classList.remove('show'), 2200);
  }

  function openEnvelope(){
    env.classList.add('open');   // CSS FIX uses .envelopeWrap.open ...
    isOpen = true;
  }

  function closeEnvelope(){
    env.classList.remove('open');
    isOpen = false;
  }

  function openLetterModal(){
    modal.classList.add('show');
  }

  function closeLetterModal(){
    modal.classList.remove('show');
  }

  // M·ªü phong th∆∞ tr∆∞·ªõc, r·ªìi hi·ªán modal (m∆∞·ª£t)
  function openThenRead(){
  if(!isOpen) openEnvelope();   // m·ªü phong th∆∞
  setTimeout(() => openLetterModal(), 500); // ƒë·ª£i animation r·ªìi m·ªü th∆∞
}

  async function toggleMusic(){
    try{
      if(!musicOn){
        await bgm.play(); // must be user-gesture triggered
        musicOn = true;
        musicBtn.textContent = "‚ùö‚ùö T·∫Øt nh·∫°c";
        showToast("Nh·∫°c ƒë√£ b·∫≠t ‚ô´");
      }else{
        bgm.pause();
        musicOn = false;
        musicBtn.textContent = "‚ô´ B·∫≠t nh·∫°c";
        showToast("ƒê√£ t·∫Øt nh·∫°c");
      }
    }catch(e){
      showToast("Kh√¥ng ph√°t ƒë∆∞·ª£c nh·∫°c: ki·ªÉm tra music.mp3 ·ªü root repo");
    }
  }

  // ===== EVENTS =====
  // Ch·∫°m phong th∆∞: n·∫øu ch∆∞a m·ªü -> m·ªü; n·∫øu ƒë√£ m·ªü -> ƒë·ªçc th∆∞
  env.addEventListener('click', (e) => {
    e.preventDefault();
    e.stopPropagation();
    if(!isOpen) openEnvelope();
    else openLetterModal();
  });

  // N√∫t tr√™n c√πng "M·ªü th∆∞": m·ªü phong th∆∞
  openBtn.addEventListener('click', (e) => {
    e.preventDefault();
    openEnvelope();
    showToast("B·∫•m ‚Äúƒê·ªçc th∆∞‚Äù ƒë·ªÉ xem n·ªôi dung");
  });

  // N√∫t "ƒê·ªçc th∆∞": m·ªü phong th∆∞ tr∆∞·ªõc r·ªìi hi·ªán th∆∞
  readBtn.addEventListener('click', (e) => {
  e.preventDefault();
  e.stopPropagation();
  openThenRead();
});

  // N√∫t "ƒê√≥ng phong th∆∞"
  closeAnimBtn.addEventListener('click', (e) => {
  e.preventDefault();
  e.stopPropagation();
  closeLetterModal();  // n·∫øu ƒëang m·ªü th∆∞ th√¨ ƒë√≥ng
  closeEnvelope();     // ƒë√≥ng phong th∆∞
});

  // ƒê√≥ng modal
  closeModal.addEventListener('click', (e) => {
    e.preventDefault();
    closeLetterModal();
  });

  // Click n·ªÅn t·ªëi ƒë·ªÉ ƒë√≥ng
  modal.addEventListener('click', (e) => {
    if(e.target === modal) closeLetterModal();
  });

  // ESC ƒë√≥ng th∆∞
  document.addEventListener('keydown', (e) => {
    if(e.key === "Escape") closeLetterModal();
  });

  // Nh·∫°c
  musicBtn.addEventListener('click', (e) => {
    e.preventDefault();
    toggleMusic();
  });
  </script>
</body>
</html>
